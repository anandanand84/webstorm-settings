<templateSet group="user">
  <template name="batch-scheduler" value="var start = 0;&#10;var end = start + batchsize;&#10;&#10;var startMethod = function(req,res,next){&#10;    fs.readFile('CM_trades', 'utf8', function (err,data) {&#10;        if (err) {&#10;            return console.log(err);&#10;        }&#10;        var lines = data.split('\n');&#10;        console.log('Scheduleing lines between '+start+ ' and ' + end);&#10;        scheduler(lines, start, end)&#10;    });&#10;    res.send('simulation started')&#10;};&#10;&#10;var scheduler = function(lines,start, end){&#10;    winston.profile('Time taken for '+batchsize);&#10;    Promise.all(processData(lines, start, end)).then(function(){&#10;        winston.profile('Time taken for '+batchsize);&#10;        var newStart = end;&#10;        var newEnd   = end + batchsize;&#10;        if(newEnd &gt; lines.length){&#10;            newEnd  = lines.length;&#10;        }&#10;        console.log('Scheduleing lines between '+newStart+ ' and ' + newEnd);&#10;        if(newStart &lt; lines.length){&#10;            scheduler(lines,newStart, newEnd)&#10;        }&#10;    })&#10;}&#10;&#10;var processData = function(line, start, end){&#10;    var promises = [];&#10;    var promise;&#10;    for(var i=start; i &lt; end; i++){&#10;        promises.push(pushQuotes(line[i]));&#10;    }&#10;    return promises;&#10;}&#10;&#10;module.exports = startMethod;&#10;&#10;startMethod(undefined, {send : function(){}}, undefined);" description="batch-scheduler - Synchronously do a batch task, helps in preventing out of memory" toReformat="true" toShortenFQNames="true">
    <context>
      <option name="HTML_TEXT" value="false" />
      <option name="HTML" value="false" />
      <option name="XSL_TEXT" value="false" />
      <option name="XML" value="false" />
      <option name="XML_TEXT" value="false" />
      <option name="JSON" value="false" />
      <option name="LUA" value="false" />
      <option name="JSP" value="false" />
      <option name="CSS_PROPERTY_VALUE" value="false" />
      <option name="CSS_DECLARATION_BLOCK" value="false" />
      <option name="CSS_RULESET_LIST" value="false" />
      <option name="CSS" value="false" />
      <option name="CUCUMBER_FEATURE_FILE" value="false" />
      <option name="Bash" value="false" />
      <option name="JAVA_SCRIPT" value="false" />
      <option name="JS_EXPRESSION" value="false" />
      <option name="JSX_HTML" value="false" />
      <option name="JS_STATEMENT" value="true" />
      <option name="TypeScript" value="false" />
      <option name="Handlebars" value="false" />
      <option name="JADE" value="false" />
      <option name="CoffeeScript" value="false" />
      <option name="HAML" value="false" />
      <option name="DART" value="false" />
      <option name="OTHER" value="false" />
    </context>
  </template>
</templateSet>